\chapter{Практическая часть}

% \section{Особенности программной реализации}

\section{Цель и задачи эксперимента}
Целью работы является исследование эффективности методов кластеризации Гат-Гевы, K-средних и C-средних на размеченном наборе текстовых данных. Для этого необходимо:
\begin{enumerate}
    \item Предобработать тексты и создать векторные представления документов двумя методами;
    \item Провести кластеризацию с использованием указанных методов, варьируя количество кластеров \( k \);
    \item Рассчитать метрики внутрикластерного и межкластерного расстояний для оценки качества разбиения;
    \item Сравнить полученные кластеризации с экспертной разметкой.
\end{enumerate}

\section{Описание набора данных}
Работа проводились на предоставленном размеченном наборе текстовых данных. Набор содержит \( N = 50 \) текстовых документов, относящихся к \(K = 7 \) тематическим кластерам согласно экспертной разметке.

\section{Предобработка текста и векторизация}
Векторизация документов выполнялась в два этапа: предобработка текста и создание числового вектора.

В ходе первого этапа исходный текст очищался от знаков препинания, символов перевода строк и приводился к нижнему регистру. После этого каждый документ разбивался на отдельные слова (токены) с помощью простого разделителя по пробелам. 

Для получения начальных форм слов использовалась библиотека \texttt{pymorphy3}. Каждый токен, полученный на предыдущем этапе, преобразовывался в свою нормальную форму (лемму).

\section{Создание векторных представлений}
После лемматизации для каждого из двух методов (мешок словоформ и мешок лемм) выполнялась векторизация. В результате каждый документ \( d_i \) был представлен как вектор \( \mathbf{x}_i \), где каждая компонента соответствовала весу конкретного слова (словоформы или леммы) в документе. Служебные части речи при векторизации не учитывались.

\section{Результаты кластеризации с лемматизацией}

\subsection{Метод К-средних}

Ниже на рисунках \ref{img:k_7}-\ref{img:k_10} представлены результаты кластеризации методом К-средних с лемматизацией.

\includeimage
    {k_7} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=7} % Подпись рисунка

\newpage

\includeimage
    {k_2} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=2} % Подпись рисунка

\includeimage
    {k_3} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=3} % Подпись рисунка

\newpage


\includeimage
    {k_4} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=4} % Подпись рисунка

\includeimage
    {k_5} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=5} % Подпись рисунка

\newpage


\includeimage
    {k_6} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=6} % Подпись рисунка

\includeimage
    {k_10} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=10} % Подпись рисунка

\newpage

\subsection{Метод С-средних}

Ниже на рисунках \ref{img:c_7}-\ref{img:c_10} представлены результаты кластеризации методом C-средних с лемматизацией.

\includeimage
    {c_7} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=7} % Подпись рисунка

\includeimage
    {c_2} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=2} % Подпись рисунка

\newpage


\includeimage
    {c_3} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=3} % Подпись рисунка

\includeimage
    {c_4} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=4} % Подпись рисунка

\newpage


\includeimage
    {c_5} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=5} % Подпись рисунка

\includeimage
    {c_6} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=6} % Подпись рисунка

\newpage


\includeimage
    {c_10} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=10} % Подпись рисунка

\section{Результаты кластеризации без лемматизации}

\subsection{Метод К-средних}

Ниже на рисунках \ref{img:wk_7}-\ref{img:wk_10} представлены результаты кластеризации методом К-средних без лемматизации.

\includeimage
    {wk_7} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=7} % Подпись рисунка

\newpage


\includeimage
    {wk_2} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=2} % Подпись рисунка

\includeimage
    {wk_3} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=3} % Подпись рисунка

\newpage


\includeimage
    {wk_4} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=4} % Подпись рисунка

\includeimage
    {wk_5} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=5} % Подпись рисунка

\newpage


\includeimage
    {wk_6} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=6} % Подпись рисунка

\includeimage
    {wk_10} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом К-средних, при К=10} % Подпись рисунка

\newpage

\subsection{Метод С-средних}

Ниже на рисунках \ref{img:wc_7}-\ref{img:wc_10} представлены результаты кластеризации методом C-средних без лемматизации.

\includeimage
    {wc_7} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=7} % Подпись рисунка

\includeimage
    {wc_2} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=2} %Подпись рисунка

\newpage


\includeimage
    {wc_3} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=3} % Подпись рисунка

\includeimage
    {wc_4} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=4} % Подпись рисунка

\newpage


\includeimage
    {wc_5} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=5} % Подпись рисунка

\includeimage
    {wc_6} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=6} % Подпись рисунка

\newpage


\includeimage
    {wc_10} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом C-средних, при К=10} % Подпись рисунка

\section{Метод Гат-Гевы}

Решение задачи кластеризации методом Гат-Гевы выполнялась на языке \texttt{matlab} ввиду отсутствия готовых реализаций на языке \texttt{python} (справедливости ради, мною были найдены готовые реализации этого метода кластеризации, однако ввиду того что они были написаны достаточно давно, текущие версии библиотек их не поддерживали, а заниматься их реанимацией мне не хотелось, посему было принято решение реализовать этот метод в \texttt{matlab}, где Гат-Гева входит в состав одного из \textit{toolbox}).

В \texttt{matlab} метод Гат-Гевы реализован в рамках \texttt{Fuzzy Logic Toolbox}.Результат задачи кластеризации методом Гат-Гевы при стандартных размерностях векторов документов, представленный на рисунке \ref{img:g_7} не дают ожидаемого результата.

Однако, предварительно перед кластеризацией уменьшив размерность векторов методом главных компонент удалось получить результат представленный на рисунке \ref{img:g_7_pca}.

Ниже на рисунках \ref{img:g_10_pca} и \ref{img:g_2_pca_w} представлены примеры решения задачи кластеризации методом Гат-Гевы при различных параметрах.

\newpage


\includeimage
    {g_7} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом Гат-Гевы при стандартный размерностях векторов, при К=7} % Подпись рисунка

\includeimage
    {g_7_pca} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом Гат-Гевы при преобразованных векторах и лемматизации, при К=7} % Подпись рисунка

\newpage

\includeimage
    {g_10_pca} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом Гат-Гевы при преобразованных векторах и лемматизации, при К=10} % Подпись рисунка

\includeimage
    {g_2_pca} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом Гат-Гевы при преобразованных векторах и лемматизации, при К=2} % Подпись рисунка

\newpage
 
    \includeimage
    {g_7_pca_w} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом Гат-Гевы при преобразованных векторах и без лемматизации, при К=10} % Подпись рисунка

\includeimage
    {g_2_pca_w} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {1\textwidth} % Ширина рисунка
    {Результат кластеризации методом Гат-Гевы при преобразованных векторах и без лемматизации, при К=2} % Подпись рисунка

\newpage


\section{Сравнительная таблица}




% \includelistingpretty
%     {out.txt} % Имя файла с расширением (файл должен быть расположен в директории inc/lst/)
%     {} % Язык программирования (необязательный аргумент)
%     {Пример работы с консольной программой} % Подпись листинга




\chapter*{ЗАКЛЮЧЕНИЕ}


